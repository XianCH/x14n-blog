<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>spring架构分析 | x14n</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="/x14n-blog/styles/custom.css">
    <meta name="description" content="STAY HUNGER,STAY FOOLISH">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/x14n-blog/assets/css/0.styles.c5be36f0.css" as="style"><link rel="preload" href="/x14n-blog/assets/js/app.0bf6b832.js" as="script"><link rel="preload" href="/x14n-blog/assets/js/7.5ae92d3c.js" as="script"><link rel="preload" href="/x14n-blog/assets/js/2.f34688e4.js" as="script"><link rel="preload" href="/x14n-blog/assets/js/1.8dfff511.js" as="script"><link rel="preload" href="/x14n-blog/assets/js/69.028eae9e.js" as="script"><link rel="prefetch" href="/x14n-blog/assets/js/10.80b19368.js"><link rel="prefetch" href="/x14n-blog/assets/js/11.eca95232.js"><link rel="prefetch" href="/x14n-blog/assets/js/14.65ec719e.js"><link rel="prefetch" href="/x14n-blog/assets/js/15.55722028.js"><link rel="prefetch" href="/x14n-blog/assets/js/16.11e89e57.js"><link rel="prefetch" href="/x14n-blog/assets/js/17.072265ce.js"><link rel="prefetch" href="/x14n-blog/assets/js/18.9264737b.js"><link rel="prefetch" href="/x14n-blog/assets/js/19.68ab4bad.js"><link rel="prefetch" href="/x14n-blog/assets/js/20.6cd93213.js"><link rel="prefetch" href="/x14n-blog/assets/js/21.b972a304.js"><link rel="prefetch" href="/x14n-blog/assets/js/22.bb58b275.js"><link rel="prefetch" href="/x14n-blog/assets/js/23.f4963f8f.js"><link rel="prefetch" href="/x14n-blog/assets/js/24.1d11efd9.js"><link rel="prefetch" href="/x14n-blog/assets/js/25.546aba52.js"><link rel="prefetch" href="/x14n-blog/assets/js/26.dfc21ea4.js"><link rel="prefetch" href="/x14n-blog/assets/js/27.5a57dd7f.js"><link rel="prefetch" href="/x14n-blog/assets/js/28.3f595efb.js"><link rel="prefetch" href="/x14n-blog/assets/js/29.69202bc7.js"><link rel="prefetch" href="/x14n-blog/assets/js/3.0854eb75.js"><link rel="prefetch" href="/x14n-blog/assets/js/30.e344efe0.js"><link rel="prefetch" href="/x14n-blog/assets/js/31.49ac6ce7.js"><link rel="prefetch" href="/x14n-blog/assets/js/32.71f0bab9.js"><link rel="prefetch" href="/x14n-blog/assets/js/33.720bfc4b.js"><link rel="prefetch" href="/x14n-blog/assets/js/34.9529d302.js"><link rel="prefetch" href="/x14n-blog/assets/js/35.c8ef20b8.js"><link rel="prefetch" href="/x14n-blog/assets/js/36.4604d668.js"><link rel="prefetch" href="/x14n-blog/assets/js/37.17c601a5.js"><link rel="prefetch" href="/x14n-blog/assets/js/38.62b174a4.js"><link rel="prefetch" href="/x14n-blog/assets/js/39.6bac3f2d.js"><link rel="prefetch" href="/x14n-blog/assets/js/4.afe772ca.js"><link rel="prefetch" href="/x14n-blog/assets/js/40.9b7689f4.js"><link rel="prefetch" href="/x14n-blog/assets/js/41.71a9acde.js"><link rel="prefetch" href="/x14n-blog/assets/js/42.6baf99f1.js"><link rel="prefetch" href="/x14n-blog/assets/js/43.57ecda17.js"><link rel="prefetch" href="/x14n-blog/assets/js/44.4d583ca3.js"><link rel="prefetch" href="/x14n-blog/assets/js/45.ea6eb053.js"><link rel="prefetch" href="/x14n-blog/assets/js/46.bc05fd53.js"><link rel="prefetch" href="/x14n-blog/assets/js/47.0fd2464d.js"><link rel="prefetch" href="/x14n-blog/assets/js/48.2975a75b.js"><link rel="prefetch" href="/x14n-blog/assets/js/49.26cad6d0.js"><link rel="prefetch" href="/x14n-blog/assets/js/5.9fe33567.js"><link rel="prefetch" href="/x14n-blog/assets/js/50.57500091.js"><link rel="prefetch" href="/x14n-blog/assets/js/51.f5dbef1f.js"><link rel="prefetch" href="/x14n-blog/assets/js/52.e7d420ca.js"><link rel="prefetch" href="/x14n-blog/assets/js/53.0879498a.js"><link rel="prefetch" href="/x14n-blog/assets/js/54.895bb4c8.js"><link rel="prefetch" href="/x14n-blog/assets/js/55.d59355f6.js"><link rel="prefetch" href="/x14n-blog/assets/js/56.5e5b07d2.js"><link rel="prefetch" href="/x14n-blog/assets/js/57.081c5d83.js"><link rel="prefetch" href="/x14n-blog/assets/js/58.7ad565b8.js"><link rel="prefetch" href="/x14n-blog/assets/js/59.1d98445b.js"><link rel="prefetch" href="/x14n-blog/assets/js/6.269dc953.js"><link rel="prefetch" href="/x14n-blog/assets/js/60.0dbd0de1.js"><link rel="prefetch" href="/x14n-blog/assets/js/61.055e152a.js"><link rel="prefetch" href="/x14n-blog/assets/js/62.75ea8725.js"><link rel="prefetch" href="/x14n-blog/assets/js/63.aa769f87.js"><link rel="prefetch" href="/x14n-blog/assets/js/64.6108248c.js"><link rel="prefetch" href="/x14n-blog/assets/js/65.ccb1e39b.js"><link rel="prefetch" href="/x14n-blog/assets/js/66.b1045178.js"><link rel="prefetch" href="/x14n-blog/assets/js/67.4d1253cd.js"><link rel="prefetch" href="/x14n-blog/assets/js/68.fb3c884b.js"><link rel="prefetch" href="/x14n-blog/assets/js/70.d2879234.js"><link rel="prefetch" href="/x14n-blog/assets/js/71.319d9b8b.js"><link rel="prefetch" href="/x14n-blog/assets/js/72.05f2fbd9.js"><link rel="prefetch" href="/x14n-blog/assets/js/73.14e4ad11.js"><link rel="prefetch" href="/x14n-blog/assets/js/74.48c9a3e7.js"><link rel="prefetch" href="/x14n-blog/assets/js/75.e616032b.js"><link rel="prefetch" href="/x14n-blog/assets/js/76.61b598b4.js"><link rel="prefetch" href="/x14n-blog/assets/js/77.0af3c7a6.js"><link rel="prefetch" href="/x14n-blog/assets/js/78.3101f2e5.js"><link rel="prefetch" href="/x14n-blog/assets/js/79.88317f3c.js"><link rel="prefetch" href="/x14n-blog/assets/js/8.fa1c2b35.js"><link rel="prefetch" href="/x14n-blog/assets/js/80.a1c43ff4.js"><link rel="prefetch" href="/x14n-blog/assets/js/9.e2c14be6.js"><link rel="prefetch" href="/x14n-blog/assets/js/vendors~docsearch.0bf5d0c2.js">
    <link rel="stylesheet" href="/x14n-blog/assets/css/0.styles.c5be36f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>x14n</h3> <p class="description" data-v-59e6cb88>STAY HUNGER,STAY FOOLISH</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>x14n</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/x14n-blog/" class="home-link router-link-active"><img src="/x14n-blog/lp.png" alt="x14n" class="logo"> <span class="site-name">x14n</span></a> <div class="links"><!----> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/x14n-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/go/" class="nav-link"><i class="undefined"></i>
  go
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/other/" class="nav-link"><i class="undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/spring/" class="nav-link"><i class="undefined"></i>
  spring
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/springboot/" class="nav-link"><i class="undefined"></i>
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/缓存/" class="nav-link"><i class="undefined"></i>
  缓存
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li></ul></div></div><div class="nav-item"><a href="/x14n-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/x14n-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/XianCH" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/x14n-blog/lp.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    x14n
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>39</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>32</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/x14n-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/linux/" class="nav-link"><i class="undefined"></i>
  linux
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/go/" class="nav-link"><i class="undefined"></i>
  go
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/java/" class="nav-link"><i class="undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/other/" class="nav-link"><i class="undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/spring/" class="nav-link"><i class="undefined"></i>
  spring
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/分布式/" class="nav-link"><i class="undefined"></i>
  分布式
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/springboot/" class="nav-link"><i class="undefined"></i>
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/缓存/" class="nav-link"><i class="undefined"></i>
  缓存
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/x14n-blog/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li></ul></div></div><div class="nav-item"><a href="/x14n-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/x14n-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/XianCH" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>x14n</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">spring架构分析</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>x14n</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>4/6/2023</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>spring framework</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="spring架构分析"><a href="#spring架构分析" class="header-anchor">#</a> spring架构分析</h2> <h2 id="spring核心特性-aop-ioc"><a href="#spring核心特性-aop-ioc" class="header-anchor">#</a> spring核心特性 aop ioc</h2> <h3 id="_1-ioc"><a href="#_1-ioc" class="header-anchor">#</a> 1，	ioc</h3> <ul><li><p>概念：</p> <p>ioc(inversion of controller) 控制反转是一种设计思想，依赖注入(dependency injection)是ioc思想的一种实现，spirng<br>
用的就是依赖注入,通过注入对象的方式来解决对象依赖之间的关系。</p> <p>spring在初始化的时候，spring会去扫描（如@Component，@Service等）等注解的class，然后将这些实例纳入容器中进行管理。在容器中管理的对象被称为bean，这个过程被称为bean的创建和管理。</p> <p>当ioc容器在创建bean实例时，需要解决bean之间的依赖关系，这就需要用到了依赖注入，Spring 通过反射来获取 Bean 中的字段和方法，并为这些字段和方法注入对应的值，以实现依赖注入。</p></li> <li><p>实例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Compont</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span><span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">syaHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span> <span class="token operator">+</span> userDao<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDaoImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Stirng</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token char">'jack'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">AnnotationConfigApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		context<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token string">&quot;com.x14n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		context<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">UserService</span> userService <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		userService<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">autowireBeanProperties</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> beanClass <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> beanClass<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Autowired</span> autowired <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Autowired</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>autowired <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> dependency <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> beanName <span class="token operator">=</span> autowired<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dependency <span class="token operator">=</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> dependencyType <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dependency <span class="token operator">=</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>dependencyType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">boolean</span> accessible <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">isAccessible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>accessible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span> dependency<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span><span class="token string">&quot;Could not autowire field: &quot;</span> <span class="token operator">+</span> field<span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>accessible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个方法的作用是：遍历传入的 <code>bean</code> 对象中的所有字段（包括私有字段），如果发现某个字段被 <code>@Autowired</code> 注解修饰，说明该字段需要自动装配其依赖的对象，此时 Spring 就会根据该字段的类型在容器中查找对应的 Bean 实例，并通过 Java 的反射机制将其注入到该字段中。</p> <p>具体实现过程如下：</p> <ol><li>首先，获取传入的 <code>bean</code> 对象的 Class 对象。</li> <li>然后，通过反射获取该 Class 对象中声明的所有字段（包括私有字段）。</li> <li>遍历这些字段，判断每个字段是否被 <code>@Autowired</code> 注解修饰。</li> <li>如果该字段被 <code>@Autowired</code> 注解修饰，说明该字段需要自动装配其依赖的对象。此时，通过 <code>beanFactory</code> 参数获取容器中对应的 Bean 实例。</li> <li>最后，通过 Java 的反射机制将获取到的 Bean 实例注入到该字段中。</li></ol> <p>需要注意的是，如果一个类中有多个字段被 <code>@Autowired</code> 注解修饰，Spring 只会自动装配类型匹配的 Bean 实例，如果找到了多个匹配的 Bean 实例，会抛出 <code>NoUniqueBeanDefinitionException</code> 异常，需要手动指定要注入的 Bean 实例。</p> <p>这段代码是 Spring Framework 中的一小部分，结合整个框架的其他代码和配置文件，才能实现完整的 IoC 和 DI 功能。</p></li> <li><p>BeanFactory 和ApplicationFactory</p> <p>在 Spring 中，BeanFactory 是 IoC 的基础，它是 Spring 中的最底层容器，提供了 IoC 的基本功能，如实例化对象、配置对象及管理对象之间的依赖关系等。而 ApplicationContext 是 BeanFactory 的子接口，它继承了 BeanFactory 的所有功能，同时提供了更多高级特性，例如事件传播、国际化支持等。</p> <p>ApplicationContext 在 BeanFactory 的基础上增加了以下几个方面的特性：</p> <ol><li>提供了更丰富的资源访问方式，如访问文件系统、ClassPath、URL、数据库等资源。</li> <li>提供了更方便的 MessageSource，可以轻松实现国际化。</li> <li>提供了事件机制，能够监听 ApplicationContext 中的事件，响应事件变化。</li> <li>提供了更加丰富的 AOP 支持。</li></ol> <p>因此，ApplicationContext 可以看作是一个更高级的容器，提供了更多的特性和便利性。当我们在实际开发中需要更加高级的功能时，会优先选择 ApplicationContext。</p></li> <li><p>反射：<br>
spirng的ioc底层都是通过反射机制来实现</p></li> <li><p>bean创建的整个过程概述</p> <p>假设我们有一个类<code>MyService</code>，它被标注了<code>@Component</code>注解，同时在这个类中，我们通过<code>@Autowired</code>注解注入了一个<code>MyRepository</code>类型的依赖：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>那么当我们通过Spring创建<code>MyService</code>对象时，Spring会按照以下步骤进行：</p> <ol><li>扫描组件：Spring容器启动时，会扫描所有被<code>@Component</code>或其他注解（如<code>@Controller</code>、<code>@Service</code>等）标注的类，将这些类作为组件（Bean）加入到容器中。</li> <li>创建BeanDefinition：当扫描到<code>MyService</code>类时，Spring会创建一个<code>BeanDefinition</code>对象，该对象包含了<code>MyService</code>类的相关信息，如类名、构造函数、属性等。</li> <li>创建实例：Spring根据<code>BeanDefinition</code>信息创建一个<code>MyService</code>实例，这个实例会存储在Spring容器中。</li> <li>属性注入：Spring扫描<code>MyService</code>类中的属性，发现<code>MyRepository</code>属性上标注了<code>@Autowired</code>注解，于是Spring会查找容器中是否存在<code>MyRepository</code>类型的Bean，找到之后，通过反射将该Bean注入到<code>MyService</code>实例中的<code>myRepository</code>属性上。</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 1. 扫描组件</span>
<span class="token class-name">ClassPathBeanDefinitionScanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathBeanDefinitionScanner</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
scanner<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token string">&quot;com.example&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 创建BeanDefinition</span>
<span class="token class-name">BeanDefinition</span> myServiceBeanDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myServiceBeanDefinition<span class="token punctuation">.</span><span class="token function">setBeanClass</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myServiceBeanDefinition<span class="token punctuation">.</span><span class="token function">setPropertyValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;myRepository&quot;</span><span class="token punctuation">,</span> myRepository<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 创建实例</span>
<span class="token class-name">MyService</span> myService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">)</span> myServiceBeanDefinition<span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 4. 属性注入</span>
<span class="token class-name">AutowiredAnnotationBeanPostProcessor</span> autowiredAnnotationBeanPostProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutowiredAnnotationBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
autowiredAnnotationBeanPostProcessor<span class="token punctuation">.</span><span class="token function">postProcessPropertyValues</span><span class="token punctuation">(</span>myServiceBeanDefinition<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> myService<span class="token punctuation">,</span> <span class="token string">&quot;myService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>在上述代码中，<code>ClassPathBeanDefinitionScanner</code>用于扫描<code>com.example</code>包中的组件，然后创建相应的<code>BeanDefinition</code>对象。<code>GenericBeanDefinition</code>用于创建<code>BeanDefinition</code>对象，其中设置了<code>MyService</code>的类类型和<code>myRepository</code>属性的值。接下来，通过<code>BeanDefinition</code>对象创建<code>MyService</code>实例，并将该实例存储在Spring容器中。最后，<code>AutowiredAnnotationBeanPostProcessor</code>用于处理<code>@Autowired</code>注解，将<code>myRepository</code>属性注入到<code>MyService</code>实例中。</p></li></ul> <h6 id=""><a href="#" class="header-anchor">#</a></h6> <h3 id="_2-aop"><a href="#_2-aop" class="header-anchor">#</a> 2，	aop</h3> <ul><li><p>概述:</p> <p>Spring AOP（面向切面编程）是 Spring 框架中的一个重要组成部分，它提供了一种在运行时通过动态代理技术来对程序进行横切关注点的处理机制。AOP 是一种编程范式，它允许开发者在不改变原有代码的情况下，通过定义切面（Aspect）和切点（Pointcut），在程序的某些特定执行点上插入通知（Advice），从而实现对原有程序行为的增强、修改、拦截和重用等操作。在 Spring 框架中，AOP 功能的实现主要依赖于 JDK 动态代理和 CGLIB（Code Generation Library）代码生成库两种技术。</p></li></ul> <p>动态代理</p></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/x14n-blog/views/xue-xi/spring/spring-framework/springjia-gou-fen-xi.html#spring架构分析" class="sidebar-link reco-side-spring架构分析" data-v-b57cc07c>spring架构分析</a></li><li class="level-2" data-v-b57cc07c><a href="/x14n-blog/views/xue-xi/spring/spring-framework/springjia-gou-fen-xi.html#spring核心特性-aop-ioc" class="sidebar-link reco-side-spring核心特性-aop-ioc" data-v-b57cc07c>spring核心特性 aop ioc</a></li><li class="level-3" data-v-b57cc07c><a href="/x14n-blog/views/xue-xi/spring/spring-framework/springjia-gou-fen-xi.html#_1-ioc" class="sidebar-link reco-side-_1-ioc" data-v-b57cc07c>1，	ioc</a></li><li class="level-3" data-v-b57cc07c><a href="/x14n-blog/views/xue-xi/spring/spring-framework/springjia-gou-fen-xi.html#_2-aop" class="sidebar-link reco-side-_2-aop" data-v-b57cc07c>2，	aop</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/x14n-blog/assets/js/app.0bf6b832.js" defer></script><script src="/x14n-blog/assets/js/7.5ae92d3c.js" defer></script><script src="/x14n-blog/assets/js/2.f34688e4.js" defer></script><script src="/x14n-blog/assets/js/1.8dfff511.js" defer></script><script src="/x14n-blog/assets/js/69.028eae9e.js" defer></script>
  </body>
</html>
